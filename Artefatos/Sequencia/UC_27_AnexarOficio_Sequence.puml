@startuml
skinparam shadowing false
skinparam monochrome false
skinparam sequenceMessageAlign center
skinparam ParticipantBorderColor #333
skinparam ParticipantBackgroundColor #F7F7F7
skinparam ArrowColor #555
skinparam NoteBackgroundColor #fffbe6
title UC 27 - Anexar Ofício (Sequência)

actor Usuario as User
control DemandaOficioController as C
control DemandaOficioService as S
database DemandaOficioDB as DB
control AbrirDemandaService as INC_AbrirDemandaService
control RegistrarPessoaAtendidaService as EXT_RegistrarPessoaAtendidaService
control DefinirPrazoService as EXT_DefinirPrazoService
control AtribuirResponsavelService as EXT_AtribuirResponsavelService

' Fluxo principal
User -> C : 1. Solicita "Anexar Ofício"
C -> S : 2. Executa lógica de negócio
S -> INC_AbrirDemandaService : 2.1 Chama AbrirDemandaService
INC_AbrirDemandaService -> DB : 2.1.1 Operação CRUD relacionada
DB --> INC_AbrirDemandaService : 2.1.2 OK/Resultado
INC_AbrirDemandaService --> S : 2.1.3 Retorno
S -> DB : 3. Operação CRUD (criar/atualizar/consultar)
DB --> S : 4. Resultado
S -> EXT_RegistrarPessoaAtendidaService : 5.1 Extensão RegistrarPessoaAtendida
EXT_RegistrarPessoaAtendidaService -> DB : 5.1.1 Operação CRUD
DB --> EXT_RegistrarPessoaAtendidaService : 5.1.2 OK/Resultado
EXT_RegistrarPessoaAtendidaService --> S : 5.1.3 Retorno
S -> EXT_DefinirPrazoService : 5.2 Extensão DefinirPrazo
EXT_DefinirPrazoService -> DB : 5.2.1 Operação CRUD
DB --> EXT_DefinirPrazoService : 5.2.2 OK/Resultado
EXT_DefinirPrazoService --> S : 5.2.3 Retorno
S -> EXT_AtribuirResponsavelService : 5.3 Extensão AtribuirResponsavel
EXT_AtribuirResponsavelService -> DB : 5.3.1 Operação CRUD
DB --> EXT_AtribuirResponsavelService : 5.3.2 OK/Resultado
EXT_AtribuirResponsavelService --> S : 5.3.3 Retorno
S --> C : 6. Resposta de negócio
C --> User : 7. Sucesso/Feedback
note over C,S
Includes: AbrirDemanda\nExtends: RegistrarPessoaAtendida, DefinirPrazo, AtribuirResponsavel
end note

@enduml