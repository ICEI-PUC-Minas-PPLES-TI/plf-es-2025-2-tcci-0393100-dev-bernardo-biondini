@startuml
title Diagrama de Componentes (UML) – Sistema Gabinete Inteligente

skinparam componentStyle uml2
skinparam shadowing false

' ================= Subsistema Frontend =======================
package "Frontend Web (React)" <<Subsystem>> {
  [Interface Web] <<Component>>
  [HTTP Client] <<Component>>
}

[Interface Web] --> [HTTP Client] : Envia requisições REST

' ================= Backend - API REST =========================
package "Backend API (Laravel)" <<Subsystem>> {

  [API Gateway] <<Component>>

  package "Controladores (Controllers)" <<Subsystem>> {
    [AuthController] <<Component>>
    [DemandasController] <<Component>>
    [EmendasController] <<Component>>
    [CidadesController] <<Component>>
    [InstituicoesController] <<Component>>
    [AgendaController] <<Component>>
    [RelatoriosController] <<Component>>
  }

  package "Serviços de Aplicação" <<Subsystem>> {
    [AuthService] <<Component>>
    [DemandasService] <<Component>>
    [EmendasService] <<Component>>
    [CidadesService] <<Component>>
    [InstituicoesService] <<Component>>
    [AgendaService] <<Component>>
    [RelatoriosService] <<Component>>
  }

  package "Autorização e Segurança" <<Subsystem>> {
    [Policies] <<Component>>
    [Guards/JWT] <<Component>>
  }
}

' ================= Backend - Domínio & Persistência ===========
package "Domínio & Persistência" <<Subsystem>> {
  [Eloquent Models] <<Component>>
  [DTOs / Resources] <<Component>>
  database "MySQL" as DB
}

' ================= Infraestrutura =============================
package "Infraestrutura" <<Subsystem>> {
  folder "Storage (S3/Local)" as Store
  [Mail Provider] <<Component>>
}

' ================== Conexões FRONT -> BACK ====================
[HTTP Client] --> [API Gateway] : HTTPS/JSON

' ================== Controladores =============================
[API Gateway] --> [AuthController]
[API Gateway] --> [DemandasController]
[API Gateway] --> [EmendasController]
[API Gateway] --> [CidadesController]
[API Gateway] --> [InstituicoesController]
[API Gateway] --> [AgendaController]
[API Gateway] --> [RelatoriosController]

' ================== Services =================================
[AuthController] --> [AuthService]
[DemandasController] --> [DemandasService]
[EmendasController] --> [EmendasService]
[CidadesController] --> [CidadesService]
[InstituicoesController] --> [InstituicoesService]
[AgendaController] --> [AgendaService]
[RelatoriosController] --> [RelatoriosService]

' ================== Segurança ================================
[AuthService] --> [Guards/JWT]
[AuthService] --> [Policies]

[DemandasService] --> [Policies]
[EmendasService] --> [Policies]
[AgendaService] --> [Policies]
[RelatoriosService] --> [Policies]

' ================== Persistência ==============================
[DemandasService] --> [Eloquent Models]
[EmendasService] --> [Eloquent Models]
[CidadesService] --> [Eloquent Models]
[InstituicoesService] --> [Eloquent Models]
[AgendaService] --> [Eloquent Models]
[RelatoriosService] --> [Eloquent Models]

[Eloquent Models] --> DB
[RelatoriosService] --> Store
[DemandasService] --> Store

' ================== Notificações =============================
[AgendaService] --> [Mail Provider] : Envio de alertas
[DemandasService] --> [Mail Provider] : Notificações

@enduml
